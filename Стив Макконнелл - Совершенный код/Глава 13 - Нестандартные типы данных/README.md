## Глава 13 - Нестандартные типы данных
### Структуры
- используйте структуры для прояснения взаимоотношений между данными;
- используйте структуры для упрощения операций с блоками данных;
- используйте структуры для упрощения списка параметров;
- используйте структуры для упрощения сопровождения. Применяя структуры, вы группируете взаимосвязанные данные, изменение структуры требует минимальных исправлений в программе;
### Указатели
Концептуально каждый указатель состоит из двух частей: области памяти и знания, как следует интерпретировать содержимое этой области.

**Область памяти** — это адрес, часто представленный в шестнадцатеричном виде. В 32-разрядном процессоре адрес будет 32-битным числом, например 0x0001EA40. Сам по себе указатель содержит только этот адрес. Чтобы обратиться к данным, на которые этот указатель указывает, надо пойти по этому адресу и как-то интерпретировать содержимое памяти в этой области. Сам по себе этот участок памяти — просто набор битов. Чтобы он обрел смысл, его надо как-то истолковать.

### Основные советы по использованию указателей
- Изолируйте операции с указателями в методах или классах
- Выполняйте объявление и определение указателей одновременно
- Удаляйте указатели в той же области действия, где они были созданы
- Проверяйте указатели перед их применением
- Проверяйте переменную, на которую ссылается указатель, перед ее использованием
- Используйте закрепленные признаки для проверки повреждения памяти
- Добавьте явную избыточность
- Используйте для ясности дополнительные переменные указателей 
- Упрощайте сложные выражения с указателями
- Удаляйте указатели в связных списках в правильном порядке
- Выделите «запасной парашют» памяти. Зарезервируйте память, нужную для корректного завершения приложения и сохранения данных.
- Уничтожайте мусор
- Устанавливайте указатели null при их удалении или освобождении
- Проверяйте корректность указателя перед его удалением
- Отслеживайте распределение памяти для указателей
- Напишите методы-оболочки, чтобы централизовать стратегию борьбы с ошибками в указателях
- Используйте технологию, не основанную на указателях
## Глобальные данные
Доступны из любого места программы. Даже если применение глобальных переменных не всегда ведет к ошибкам, оно все-таки вряд ли представляет собой хороший способ программирования.
Распространенные проблемы с глобальными данными:
- Непреднамеренные изменения глобальных данных Вы можете изменить значение глобальной переменной в одном месте и ошибочно думать, что оно осталось прежним где-то в другом.
- Причудливые и захватывающие проблемы при использовании псевдонимов для глобальных данных
- Проблемы реентерабельности глобальных данных. Многопоточное приложение может работать с глобальными данными не только из разных методов, но и из разных потоков.
- Затруднение повторного использования кода, вызванное глобальными данными Для использования кода из одной программы в другой вам нужно вытащить его из первой программы и внедрить во вторую.
- Проблемы с неопределенным порядком инициализации глобальных данных
- Нарушение модульности и интеллектуальной управляемости, привносимое глобальными данными. Глобальные данные проделывают дыры в возможности модуляризации. Если вы используете глобальные данные, разве вы можете сосредоточиться только на одном методе? Нет. Вам приходится сосредоточиваться на этом методе и на всех других, в которых используются те же глобальные данные.
### Причины для использования глобальных данных
- хранение глобальных значений;
- эмуляция именованных констант;
- эмуляция перечислимых типов;
- оптимизация обращений к часто используемым данным;
- исключение бродячих данных.
Используйте глобальные данные только как последнее средство. Прежде чем использовать их, рассмотрите следующие альтернативы:
- Начните с объявления всех переменных локальными и делайте их глобальными только по необходимости.
- Различайте глобальные переменные и переменные-члены класса.
- Используйте методы доступа.
Все, что вы можете сделать с глобальными данными, вы можете сделать лучше, используя методы доступа.
- вы получаете централизованный контроль над данными. Если позднее вы обнаружите более подходящую реализацию структуры, вам не придется изменять код везде, где она упоминается.
- вы можете быть уверены, что все ссылки на переменную изолированы;
- вы автоматически получаете главные преимущества сокрытия информации.
- методы доступа легко преобразуются в абстрактные типы данных.
**Постоянное внимание к деталям и создает различие между красиво написанным ПО и наскоро слепленным кодом.**
### Основные принципы применения методов доступа для сокрытия глобальных переменных в языках, не имеющих встроенной поддержки этого:
- Требуйте, чтобы весь код обращался к данным через методы доступа.
- Требуйте, чтобы весь код обращался к глобальным данным через методы доступа.
- Не валите все глобальные данные в одну кучу.
- Управляйте доступом к глобальным переменным с помощью блокировок.
- Встройте уровень абстракции в методы доступа. Сокрытие информации за абстрактными методами доступа позволяет коду самому говорить за себя и заставляет читать программу на уровне области определения задачи, а не на уровне деталей реализации.
- Выполняйте доступ к данным на одном и том же уровне абстракции. Если вы считываете данные с помощью метода доступа, то и записывайте их с помощью метода.
### Как уменьшить риск использования глобальных данных
- разработайте соглашения по именованию, которые сделают глобальные переменные очевидными;
- создайте хорошо аннотированный список всех глобальных переменных;
- не храните промежуточных результатов в глобальных переменных;
- не считайте, что вы не используете глобальные переменные, поместив все данные в чудовищный объект и передавая его всюду.
### Ключевые моменты
- Структуры могут помочь сделать программы менее сложными, упростить их понимание и сопровождение.
- Принимая решение использовать структуру, подумайте, не будет ли класс подходить лучше.
- Работа с указателями чревата ошибками. Обезопасьте себя, используя методы или классы для доступа к ним и практику защитного программирования.
- Избегайте глобальных переменных не только потому, что они опасны, но и потому что их можно заменить чем-то лучшим.
- Если вы не можете отказаться от глобальных переменных, работайте с ними через методы доступа. Эти методы предоставляют все то же и даже больше, что и глобальные переменные.