## Глава 31 - Форматирование и стиль
Эстетический аспект программирования - форматирование исходного кода програмы. Методики, описанные в этой главе, не влияют на скорость выполнения, объем памяти и другие внешние аспекты программы. Но от них зависит, насколько легко вы сможете понять, пересмотреть и исправить этот код спустя несколько месяцев после его создания.
### Основные принципы форматирования
Хорошее визуальное форматирование показывает логическую структуру программы. Создание красивого кода - хорошо, а демонстрация структуры кода - лучше. Если одна методика лучше показывает структуру кода, а другая выглядит красивее, используйте ту, которая лучше демонстрирует структуру. Отдавая на практике предпочтение логическому представлению, обычно нельзя получить уродливый код, если только сама логика этого кода не уродлива. 

Методики, позволяющие хорошему коду выглядеть хорошо, а плохому - плохо, полезней, чем методики, позволяющие любому коду выглядеть хорошо.

```
Любой дурак может написать код, понятный компьютеру. Хорошие программисты пишут код, понятный людям. (М. Фаулер)
```

Детали конкретного способа структурирования программы гораздо менее важны, чем сам факт единообразного структурирования.

Хорошие программисты должны непредвзято относиться к привычным для них способам форматирования и признавать другие варианты, доказавшие свое преимущество по отношению к использовавшимся ранее, даже если при переходе к новым методам возникает некоторый начальный дискомфорт.

**Основная теорема форматирования**: главная цель хорошего форматирования - показать логическую структуру кода. Для этого применяют отступы и другие неотображаемые символы.
### Цели хорошего форматирования
- точно представлять логическую структуру кода;
- единообразно показывать логическую структуру кода;
- улучшать читабельность;
- выдерживать процедуру исправления. Лучшие схемы форматирования легко переносят модификацию кода. Исправление одной строки не должно приводить к изменениям нескольких других.
### Способы форматирования
- неотображаемые символы (пробелы, знаки табуляции, переводы строк и пустые строки);
- скобки. Используйте чаще, чем вам это кажется необходимым, ведь это ничего не стоит. Используйте, если есть хоть малейшее сомнение в том, как вычисляется выражение.
### Стили форматирования
- явные блоки

```
If pixelColor = Color_Red Then
	statement1
	statement2
	...
End If
```

- эмуляция явных блоков

```
if ( pixelColor == Color_Red ) {
	statement1
	statement2
	...
}
```

- использование пар begin-end (скобок) для обозначений границ блока

```
if ( pixelColor == Color_Red ) 
	{
	statement1
	statement2
	...
	}
```

- форматирование в конце строки. Применение в более сложном условном выражении ухудшит данный стиль.

```
While ( pixelColor == Color_Red ) 
	statement1
	statement2
	...
	Wend
```
### Форматирование управляющих структур
- избегайте отсутствия отступов в парах begin-end;
- избегайте двойных отступов при использовании begin-end.
### Другие соглашения
- используйте пустые строки между абзацами;
- форматируйте блоки из одного оператора единообразно;
- в сложных выражениях размещайте каждое условие на отдельной строке;
- избегайте операторов goto;
- не используйте форматирование в конце строки в виде исключения для оператора case.
### Форматирование отдельных операторов
Длина строки выражения не должна превышать 80 символов, так как строки длинее 80 символов тяжело читать, препятствуют созданию глубокой вложенности и часто не помещаются на стандартный лист бумаги, особенно если печатаются по 2 страницы кода на каждой физической странице распечатки.
**Использование пробелом для ясности**
- используйте пробелы, чтобы сделать читаемыми логические выражения;
- используйте пробелы, чтобы сделать читаемыми обращения к массиву;
- используйте пробелы, чтобы сделать читаемыми аргументы методов
**Форматирование строк с продолжением**
- сделайте так, чтобы незавершённость выражения была очевидна;
- располагайте сильно связаннеы элементы вместе;
- при переносе строк в вызове метода используйте отступ стандартного размера;
- упростите поиск конца строки с продолжением. Размещение каждого элемента на отдельной строке;
- при переносе строк в управляющем выражении делайте отступ стандартного размера;
- не выравнивайте правые части выражений присваивания;
- при переносе строк в выражениях присваивания применяйте отступы стандартного размера.
### Размещение одного оператора на строке
- даёт точное представлени о сложности программы;
- не помогает компиляторам в оптимизации;
- чтение кода происходит сверху вниз, а не слева направо;
- легко найти синтаксические ошибки, если компилятор сообщает только номера строк;
- легко выполнять пошаговую отладку кода;
- легко редактировать - удалить или временно закомментировать всю строку.

Пока вы не измерили производительность, следует сначала стремиться к ясности и корректности, а уж затем - к производительности.

Размещение объявления данных:
- каждое объявление данных - в отдельной строке;
- объявляйте переменные рядом с метом их первого использования;
- разумно упорядочивайте объявления. Если ваш список переменных настолько длинен, что ему помогает алфавитное упорядочение, ваш метод, вероятно, слишком велик.