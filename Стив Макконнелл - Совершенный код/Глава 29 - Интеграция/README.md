## Глава 29 - Интеграция

Термин "Интеграция" относится к такой операции в процессе разработки ПО, при которой вы объединяете отдельные программные компоненты в единую систему.

Поскольку интеграция выполняется после того, как разработчик завершил свое тестирование, и одновременно с системным тестированием, ее иногда считают операцией, относящейся к тестированию. Одна она достаточно сложна, и поэтому ее следует рассматривать как независимые вид деятельности.
### Поэтапная интеграция
Состоит из хорошо определенных этапов, перечисленных ниже:
- модульная разработка: проектирование, кодирование, тестирование и отладка каждого класса;
- системная интеграция: объединение классов в одну огромную систему;
- системная дезинтеграция: тестирование и отладка всей системы.

Для крошечных программ поэтапная интеграция может быть наилучшим подходом.
### Инкрементная интеграция
Вы пишете и тестируете маленькие участки программы, а затем комбинируете эти кусочки друг с другом по одному.
Имеет массу преимуществ:
- ошибки можно легко обнаружить. При поэтапной интеграции вы объединяете так много компонентов одновременно, что тяжело понять, где находится ошибка;
- в таком проекте система раньше становится работоспособной;
- вы получаете улучшенный мониторинг состояния;
- вы улучшите отношения с заказчиком. Клиенты любят видеть признаки прогресса, а инкрементная интеграция предоставляет им такую возможность гораздо чаще;
- системные модули тестируются гораздо полнее;
- вы можете создать систему за более короткое время.
### Нисходящая интеграция
Класс на вершине иерархии пишется и интегрируется первым. Для работы верхнего класса пишутся заглушки. Затем, по мере интеграции классов сверху вниз, классы заглушек заменяются реальными.

Хорошей альтернативой нисходящей интеграции в чистом виде может стать подход с вертикальным секционированием. При этом систему реализуют сверху вниз по частям, возможно, по очереди выделяя функциональные области и переходя от одной к другой.
### Восходящая интеграция
Сначала пишете класса, находящиеся внизу иерархии. Добавление низкоуровневых классов по одному, а не всех одновременно - вот что делает восходящую интеграцию инкрементной стратегией. При этом довольно рано реализуются потенциально ненадежные системные интерфейсы.
### Сендвич-интеграция
При сендвич-интеграции вы сначала объединяете верхний уровень и широко используемые классы нижнего уровня, оставив средний уровень напоследок.
### Риск-ориентированная интеграция
Вы решаете какие части системы будут самыми трудными, и реализуете их первыми. Более простые классы вы реализуете позже.
### Функционально-ориентированная интеграция
Интеграция одной функции в каждый момент времени. Вы работаете с группами классов, представляющими собой отдельные функции, поддающиеся определению, которые часто, но не всегда состоят из нескольких классов.
### Т-образная интеграция
При Т-образной интеграции вы создаете и интегрируете вертикальный срез системы, чтобы проверить архитектурныу допущения. После этого вы создаете и интегрируете основную горизонталь системы, чтобы предоставить каркас для разработки остальной функциональности.

Ни один из перечисленных подходов не является жесткой процедурой - они скорее эвристические, чем алгоритмические.

### Ежедневная сбора и дымовые тесты
Ежедневно каждый файл компилируется, компонуется и собирается в выполняемую программу. После чего прогоняется "дымовой тест" - относительная простая проверка, определяющая, "дымится" ли продукт во время выполнения.

У частой интеграции есть побочный эффект - она выявляет такие проблемы, какие в противном случае могли бы незаметно накапливаться и неожиданно проявиться в конце проекта.

- создавайте сборку ежедневно;
- проверяйте правильность сборок;
- выполняйте дымовые тесты ежедневно. Дымовой тест испытывает систему от начала и до конца. Он не должен быть всесторонним, но должен быть способен выявить основные проблемы;
- поддерживайте актуальность "дымового теста";
- автоматизируйте ежедневную сборку и дымовой тест;
- организуйте группу, отвечающую за сборки;
- вносите исправления в сборку только когда имеет смысл это делать;
- ...но не откладывайте внесение исправлений надолго;
- требуйте, чтобы разработчики проводили дымовое тестирование своего кода перед добавлением в систему;
- создайте область промежуточного хранения кода, который следует добавить к сборке;
- назначьте наказание за нарушение сборки;
- выпускайте сборки по утрам;
- создавайте сборку и проводите дымовой тест даже в экстремальных условиях.
### Непрерывная интеграция
В большинстве публикаций под "непрерывной" понимается "по крайней мере ежедневная" интеграция. Есть люди, которые термин "непрерывно" воспринимают буквально - сборка каждые пару часов. Для большинства проектов действительно непрерывная интеграция выходит за рамки разумного.
### Ключевые моменты
- последовательность конструирования и интеграционный подход влияют на порядок, в котором классы проектируются, кодируются и тестируются;
- порядок интеграции снимает затраты на тестирование и упрощает отладку;
- инкрементная интеграция имеет несколько вариантов, и, помимо совсем тривиальных проектов, любой из них лучше, чем поэтапная интеграция;
- лучший интеграционный подход для каждого конкретного проекта - обычно сочетание нисходящего, восходящего, риск-ориентированного и других интеграционных подходов. Т-образная интеграция и интеграция с вертикальным секционированием часто дают хорошие результаты;
- ежедневные сборки могут уменьшить проблемы с интеграцией, улучшить моральный климат среди разработчиков и предоставить полезную информацию, касающуюся управления проектом.